private async Task InsertarEnBandejaAsync(TarjetaModel tarjeta, string pin)
{
    try
    {
        string tipoTarjeta = _configuration["ParametrosSMS:TipoTarjeta"] ?? "TDC";

        var entidad = new BandejaEnvioSmsModel
        {
            NumeroTarjeta = tarjeta.NumeroTarjeta,
            Sms = $"Su PIN es: {pin}",
            Celular = tarjeta.TelefonoCliente, // Ajusta si el teléfono viene del request
            Telco = tarjeta.IdOperador,        // Ajusta según tu modelo
            Referencia = Guid.NewGuid().ToString(),
            FechaInicio = DateTime.Now,
            TipoTarjeta = tipoTarjeta,
            Estado = 0,
            DescripcionEstado = "NO ENVIADO"
        };

        await _bandejaRepository.AddAsync(entidad);
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "Error insertando en BandejaEnvioSMS");
    }
}
