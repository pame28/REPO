Mira, necesito agregar una plantilla de HTML, ya est치 "cargada" esta la guardo en una tabla de SQLSERVER si te fijas en el codigo ya est치 .. es esta:            _plantillaHTML = configEmail.PlantillaHTML;


Ahora... en esa plantilla dentro de un parrafo hay una etiqueta @ContenidoEmail de esta forma:

   <p>
	@ContenidoEmail
   </p>


Necesito que esa etiqueta sea reemplazada por cuerpo Final ...

y que sea esta plantilla sea la que se envia el en body del correo

Dime que modificaciones debo hacer en mi codigo


using reposicion_pin.Infrastructure.Data;
using reposicion_pin.Models;
using reposicion_pin.Repository.Interface;
using System.Net.Mail;
using System.Net.Mime;

namespace reposicion_pin.Repository
{
    public class EnvioEmailRepository : IEnvioEmailRepository
    {
        private readonly AppDbContext _dbContext;
        private readonly ILogger<EnvioEmailRepository> _logger;
        private readonly ParamAmbienteModel _paramAmbiente;

        private readonly string _serverEmail;
        private readonly string _mailFrom;
        private readonly string _mailSubject;
        private readonly string _plantillaHTML;

        public EnvioEmailRepository(
            AppDbContext dbContext,
            ILogger<EnvioEmailRepository> logger)
        {
            _dbContext = dbContext;
            _logger = logger;

            var configEmail = _dbContext
                .usp_ObtenerConfigEmail
                .AsEnumerable()
                .FirstOrDefault();

            if (configEmail == null)
                throw new Exception("No se encontr칩 configuraci칩n de ConfigEmail.");

            _serverEmail = configEmail.ServerEmail;
            _mailFrom = configEmail.MailFrom;
            _mailSubject = configEmail.MailSubject;
            _plantillaHTML = configEmail.PlantillaHTML;

            _paramAmbiente = _dbContext.ParamAmbiente
                .Where(p => p.Estado == 1)
                .OrderBy(p => p.IdRow)
                .FirstOrDefault();
        }

        public async Task<(int Codigo, string Mensaje, string MailFrom, string MailSubject)> EnviarCorreoAsync(
            string correoDestino,
            string cuerpoBase,
            string pin,
            string referencia,
            CancellationToken cancellationToken)
        {
            try
            {
                string correoFinal = _paramAmbiente?.Correo ?? correoDestino;

                string cuerpoFinal = cuerpoBase.Replace("@PIN", pin);

                using var smtp = new SmtpClient(_serverEmail)
                {
                    DeliveryMethod = SmtpDeliveryMethod.Network,
                    UseDefaultCredentials = true
                };

                using var mail = new MailMessage
                {
                    From = new MailAddress(_mailFrom),
                    Subject = _mailSubject,
                    Body = cuerpoFinal,
                    IsBodyHtml = true
                };

                mail.To.Add(correoFinal);


                await smtp.SendMailAsync(mail, cancellationToken);

                _logger.LogInformation(
                    "Correo enviado Ref:{Referencia} Destino:{Destino}",
                    referencia, correoFinal);

                return (0, "Correo enviado correctamente.", _mailFrom, _mailSubject);
            }
            catch (Exception ex)
            {
                _logger.LogError(ex,
                    "Error enviando correo Ref:{Referencia} Destino:{Destino}",
                    referencia, correoDestino);

                return (8, ex.Message, _mailFrom, _mailSubject);
            }
        }
    }
}
