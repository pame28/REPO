System.Data.Odbc.OdbcException: 'ERROR [42S02] [IBM][Controlador ODBC de System i Access][DB2 para i5/OS]SQL0204 - QCMDEXC en QSYS de tipo *N no encontrado.'

Esta excepción se generó originalmente en esta pila de llamadas:
    [Código externo]
    reposicion_pin.Repository.AS400Repository.ConfigurarLibraryListAsync(System.Data.Odbc.OdbcConnection, System.Collections.Generic.List<string>) en AS400Repository.cs
    reposicion_pin.Repository.AS400Repository.EjecutarProgramaAsync(reposicion_pin.DTOs.AS400RequestDto) en AS400Repository.cs


using reposicion_pin.DTOs;
using reposicion_pin.Repository.Interface;
using System.Data;
using System.Data.Odbc;

namespace reposicion_pin.Repository
{
    public class AS400Repository : IAS400Repository
    {
        private readonly string _as400connectionString;
        private readonly ILogger<AS400Repository> _logger;
        private readonly IConfiguracionAs400Repository _configAs400Repository;

        public AS400Repository(
            IConfiguration configuration,
            ILogger<AS400Repository> logger,
            IConfiguracionAs400Repository configAs400Repository)
        {
            _as400connectionString = configuration.GetConnectionString("AS400Connection")!;
            _logger = logger;
            _configAs400Repository = configAs400Repository;
        }

        public async Task<AS400ResponseDto> EjecutarProgramaAsync(AS400RequestDto request)
        {
            try
            {
                using var conn = new OdbcConnection(_as400connectionString);
                await conn.OpenAsync();

                var config = await _configAs400Repository.ObtenerConfiguracionAsync(1);

                await ConfigurarLibraryListAsync(conn, config.librerias);

                string trama =
                    request.NumeroTarjeta.PadRight(16) +
                    request.FechaVencimiento.PadRight(8) +
                    new string(' ', 57);

                _logger.LogInformation("Trama enviada AS400: {Trama}", trama);

                using var cmd = conn.CreateCommand();
                cmd.CommandType = CommandType.Text;
                cmd.CommandTimeout = 300;

                // IMPORTANTE: ODBC usa ?
                cmd.CommandText = "CALL BPPGM/REIMQ07RC(?)";

                var paramTrama = new OdbcParameter
                {
                    OdbcType = OdbcType.Char,
                    Size = 81,
                    Direction = ParameterDirection.InputOutput,
                   // Value = trama
                };
                paramTrama.Value = trama;
                cmd.Parameters.Add(paramTrama);

                await cmd.ExecuteNonQueryAsync();

                string tramaRespuesta = paramTrama.Value?.ToString() ?? string.Empty;
                _logger.LogInformation("Trama respuesta AS400: {Trama}", tramaRespuesta);

                return ParsearRespuesta(tramaRespuesta);
            }
            catch (OdbcException ex)
            {
                _logger.LogError(ex, "Error ODBC AS400");

                return new AS400ResponseDto
                {
                    CodigoError = "P98",
                    DescripcionError = ex.Message
                };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Error general AS400");

                return new AS400ResponseDto
                {
                    CodigoError = "P99",
                    DescripcionError = ex.Message
                };
            }
        }

        private async Task ConfigurarLibraryListAsync(OdbcConnection conn, List<string> librerias)
        {
            foreach (var comando in ConstruirComandos(librerias))
            {
                using var cmd = conn.CreateCommand();
                cmd.CommandType = CommandType.Text;
                cmd.CommandTimeout = 300;

                cmd.CommandText = "{ CALL QSYS.QCMDEXC(?, ?) }";

                var parametroComando = new OdbcParameter
                {
                    OdbcType = OdbcType.Char,
                    Size = comando.Length,
                    Value = comando
                };

                var parametroLongitud = new OdbcParameter
                {
                    OdbcType = OdbcType.Decimal,
                    Precision = 15,
                    Scale = 5,
                    Value = (decimal)comando.Length
                };

                cmd.Parameters.Add(parametroComando);
                cmd.Parameters.Add(parametroLongitud);

                await cmd.ExecuteNonQueryAsync();
            }
        }

        private List<string> ConstruirComandos(List<string> librerias)
        {
            var comandos = new List<string>();

            comandos.Add("CHGLIBL LIBL(*NONE)");

            foreach (var lib in librerias)
            {
                comandos.Add($"ADDLIBLE LIB({lib})");
            }

            return comandos;
        }

        private static AS400ResponseDto ParsearRespuesta(string trama)
        {
            if (string.IsNullOrWhiteSpace(trama))
            {
                return new AS400ResponseDto
                {
                    CodigoError = "99",
                    DescripcionError = "TRAMA RESPUESTA INVÁLIDA"
                };
            }

            trama = trama.PadRight(81);

            string pin = trama.Substring(24, 4).Trim();
            string codigoError = trama.Substring(28, 3).Trim();
            string descripcionError = trama.Substring(31, 50).Trim();

            if (!string.IsNullOrWhiteSpace(pin) &&
                string.IsNullOrWhiteSpace(codigoError) &&
                string.IsNullOrWhiteSpace(descripcionError))
            {
                return new AS400ResponseDto
                {
                    Pin = pin,
                    CodigoError = "00",
                    DescripcionError = "Pin generado exitosamente"
                };
            }

            if (!string.IsNullOrWhiteSpace(codigoError))
            {
                return new AS400ResponseDto
                {
                    CodigoError = codigoError,
                    DescripcionError = descripcionError
                };
            }

            return new AS400ResponseDto
            {
                CodigoError = "99",
                DescripcionError = "Respuesta desconocida AS400"
            };
        }
    }
}
